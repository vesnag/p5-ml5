<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>p5.js Snippets</title>
  <script src="https://cdn.jsdelivr.net/npm/p5@1.4.0/lib/p5.min.js"></script> <!-- p5.js CDN -->
  <script src="https://unpkg.com/htmx.org@1.5.0"></script> <!-- htmx CDN -->
  <script src="https://cdn.tailwindcss.com"></script> <!-- Tailwind CDN -->

  <script>
    // Inject custom colors into Tailwind via the CDN config
    tailwind.config = {
      theme: {
        extend: {
          colors: {
            lavenderPurple: '#9151b0',
            lightPink: '#cb90d2',
            deepLavender: '#7260c3',
            royalPurple: '#6930a1',
            brightMagenta: '#8f49bb',
            softPink: '#efa1cb',
            white: '#FFFFFF',
            darkPurple: '#863591',
            violet: '#623eaa',
            rosePink: '#f774aa',
            deepRed: '#8f2968',
            darkRed: '#98254c',
          }
        }
      }
    }
  </script>

</head>
<body class="bg-deepLavender text-white">

  <!-- Sketch Player at the top -->
  <div class="flex flex-col items-center justify-center py-12">
    <h2 class="text-4xl font-bold mb-6 text-brightMagenta">Snippet Player</h2>

    <!-- Player container where sketch will be displayed -->
    <div id="player-container" class="border-4 border-brightMagenta rounded-lg bg-lavenderPurple p-4 w-full md:w-1/2 h-96 flex items-center justify-center">
      <p class="text-softPink">Select a snippet to run</p>
    </div>

    <!-- Stop button will only be shown when a snippet is running -->
    <button id="stop-button" class="hidden bg-darkPurple text-white py-2 px-4 rounded mt-4 hover:bg-brightMagenta" onclick="stopSnippet()">Stop Snippet</button>
  </div>

  <!-- Snippet container below the player with 3 snippets per row -->
  <div id="snippet-container" class="grid grid-cols-1 gap-6 md:grid-cols-2 lg:grid-cols-3 px-6">

    <!-- Snippet 1 -->
    <div class="snippet">
      <div class="p-4 bg-white text-darkPurple border-4 border-lavenderPurple rounded-lg shadow hover:shadow-lg transition-shadow duration-300">
        <img src="snippets/snippet1/thumbnail.jpg" alt="Snippet 1 Thumbnail" class="w-full h-48 object-cover rounded mb-4">
        <h2 class="text-2xl font-semibold mb-2 text-royalPurple">Snippet 1</h2>
        <button hx-get="snippets/snippet1/index.html" hx-target="#player-container" class="bg-brightMagenta text-white py-2 px-4 rounded hover:bg-darkPurple" onclick="startSnippet()">Run Snippet</button>
      </div>
    </div>

    <!-- Snippet 2 -->
    <div class="snippet">
      <div class="p-4 bg-white text-darkPurple border-4 border-lavenderPurple rounded-lg shadow hover:shadow-lg transition-shadow duration-300">
        <img src="snippets/snippet2/thumbnail.jpg" alt="Snippet 2 Thumbnail" class="w-full h-48 object-cover rounded mb-4">
        <h2 class="text-2xl font-semibold mb-2 text-royalPurple">Snippet 2</h2>
        <button hx-get="snippets/snippet2/index.html" hx-target="#player-container" class="bg-brightMagenta text-white py-2 px-4 rounded hover:bg-darkPurple" onclick="startSnippet()">Run Snippet</button>
      </div>
    </div>

    <!-- Additional snippets... -->

  </div>

  <script>
    let currentSketch = null;

    // Function to start the snippet
    function startSnippet() {
      // Show the stop button
      document.getElementById('stop-button').classList.remove('hidden');
    }

    // Function to stop the currently running snippet
    function stopSnippet() {
      if (currentSketch) {
        currentSketch.remove(); // Remove the p5 sketch from the canvas
        currentSketch = null;
      }

      // Clear the player container and show the default message
      document.getElementById('player-container').innerHTML = '<p class="text-softPink">Select a snippet to run</p>';

      // Hide the stop button
      document.getElementById('stop-button').classList.add('hidden');
    }

    // Function to dynamically load a sketch and set it as the current sketch
    function loadSketch(scriptPath) {
      if (currentSketch) {
        currentSketch.remove(); // Remove previous sketch if running
      }

      // Dynamically load the new sketch
      const scriptElement = document.createElement('script');
      scriptElement.src = scriptPath;

      // Append script to the head and load the sketch into the player container
      document.head.appendChild(scriptElement);

      scriptElement.onload = function() {
        currentSketch = new p5(sketch, 'player-container');
      };
    }
  </script>

</body>
</html>
